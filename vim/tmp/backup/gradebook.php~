<?php
ini_set('display_errors', 'on');
error_reporting(E_ALL);

class PhpAryToXML
{
   private $_ary = array();
   private $_xml;
   
   public function __construct($arrayObj=NULL)
   {
      if($arrayObj != NULL)
         $this->_ary = $arrayObj; 
   }
   
   public function setPHPArray($arrayObj)
   {
      $this->_ary = $arrayObj;
   }

   public function getPHPArray()
   {
      return $this->_ary;
   }

   /**
   * The function is for converting to XML document
   */
   public static function toXML($data, $rootNodeName = 'data', $xml = null)
   {
      if ($xml == null)
      {
         $xml = simplexml_load_string("<?xml version='1.0' encoding='utf-8'?><$rootNodeName />");
      }
 
      foreach($data as $key => $value)
      {
         if (is_array($value))
         {
            $node = $xml->addChild($key);
            PhpAryToXML::toXml($value, $rootNodeName, $node);
         }
         else 
         {
            $value = htmlentities($value);
            $xml->addChild($key,$value);
         }
 
      }
      return $xml;
   }
   
   public function getXML($rootNodeName = 'data')
   {
      $this->_xml = PhpAryToXML::toXML($this->_ary, $rootNodeName, null);
      return $this->_xml;
   }
}

$class = array (
  'clid' => '5000001001388',
  'created' => '1232949661',
  'folder' => '3',
  'syr' => '2012',
  'gp' => '1',
  'gscale' => '9',
  'weighted' => '0',
  'showper' => '1',
  'stusort' => '2',
  'assnsort' => '3',
  'round' => '4',
  'stuview' => '1',
  'stumail' => '1',
  'gradelevel' => '0',
  'subject' => '0',
  'bb' => '1',
  'teachmail' => '1',
  'priteach' => '1000002975618',
  'name' => 'US History',
  'code' => 'HIST1',
  'cat' => 
  array (
    0 => 
    array (
      'num' => '1', // 'num' is the category's unique ID number
      'name' => 'Quizzes',
      'weight' => '',
      'dls' => false, // when dls=true, drop lowest score; when dls=false, don't drop the lowest score
    ),
    1 => 
    array (
      'num' => '2',
      'name' => 'Tests',
      'weight' => '',
      'dls' => false,
    ),
    2 => 
    array (
      'num' => '3',
      'name' => 'Homework',
      'weight' => '',
      'dls' => true,
    ),
  ),
  'assignments' => 
  array (
    0 => 
    array (
      'clid' => '5000001001388',
      'assnid' => '27', // 'assnid' is the assignments unique id number
      'created' => '1295052576',
      'creator' => '1000002975618',
      'type' => '1',
      'cat' => '3', // coresponds to category's 'num'
      'cal' => '1',
      'bb' => '0',
      'lastreplier' => '0',
      'lastreply' => '0',
      'replies' => '0',
      'attachments' => '0',
      'due' => '20110110',
      'points' => '75', // the number of points possible
      'title' => 'World History Essay',
    ),
    1 => 
    array (
      'clid' => '5000001001388',
      'assnid' => '10',
      'created' => '1288162330',
      'creator' => '1000002975618',
      'type' => '1',
      'cat' => '3',
      'cal' => '1',
      'bb' => '1',
      'lastreplier' => '0',
      'lastreply' => '0',
      'replies' => '0',
      'attachments' => '0',
      'due' => '20110130',
      'points' => '10',
      'title' => 'Register on Engrade',
    ),
    2 => 
    array (
      'clid' => '5000001001388',
      'assnid' => '5',
      'created' => '1281468397',
      'creator' => '1000002975618',
      'type' => '1',
      'cat' => '1',
      'cal' => '1',
      'bb' => '0',
      'lastreplier' => '0',
      'lastreply' => '0',
      'replies' => '0',
      'attachments' => '0',
      'due' => '20100810',
      'points' => '50',
      'title' => 'Founding Fathers Quiz',
    ),
    3 => 
    array (
      'clid' => '5000001001388',
      'assnid' => '4',
      'created' => '1281050394',
      'creator' => '1000002975618',
      'type' => '1',
      'cat' => '2',
      'cal' => '1',
      'bb' => '0',
      'lastreplier' => '0',
      'lastreply' => '0',
      'replies' => '0',
      'attachments' => '0',
      'due' => '20100805',
      'points' => '200',
      'title' => 'Civil War Midterm',
    ),
    4 => 
    array (
      'clid' => '5000001001388',
      'assnid' => '1',
      'created' => '1232949661',
      'creator' => '1000002975618',
      'type' => '1',
      'cat' => '3',
      'cal' => '1',
      'bb' => '0',
      'lastreplier' => '0',
      'lastreply' => '0',
      'replies' => '0',
      'attachments' => '0',
      'due' => '20100802',
      'points' => '5',
      'title' => 'Return Signed Syllabus',
    ),
  ),
  'students' => 
  array (
    0 => 
    array (
      'stuid' => 'ABC', // stuid is the student's unique alphanumberic ID string
      'num' => '1',
      'first' => 'John',
      'last' => 'Adams',
      'grade' => 'A',
      'percent' => '97.1',
    ),
    1 => 
    array (
      'stuid' => '9906',
      'num' => '2',
      'first' => 'Dwight',
      'last' => 'Eisenhower',
      'grade' => 'A',
      'percent' => '94.1',
    ),
    2 => 
    array (
      'stuid' => '9904',
      'num' => '3',
      'first' => 'James',
      'last' => 'Garfield',
      'grade' => 'A',
      'percent' => '91.5',
    ),
    3 => 
    array (
      'stuid' => '460798',
      'num' => '4',
      'first' => 'Thomas',
      'last' => 'Jefferson',
      'grade' => 'A',
      'percent' => '94.7',
    ),
    4 => 
    array (
      'stuid' => '99010',
      'num' => '5',
      'first' => 'Abraham',
      'last' => 'Lincoln',
      'grade' => 'B',
      'percent' => '87.6',
    ),
    5 => 
    array (
      'stuid' => '55678',
      'num' => '6',
      'first' => 'Franklin',
      'last' => 'Roosevelt',
      'grade' => 'A',
      'percent' => '92.9',
    ),
    6 => 
    array (
      'stuid' => '95956',
      'num' => '7',
      'first' => 'George',
      'last' => 'Washington',
      'grade' => 'B',
      'percent' => '89.1',
    ),
  ),
  'scores' => 
  array (
    0 => 
    array (
      'assnid' => '1', // corresponds to assignment's 'assnid'
      'stuid' => '460798', // corresponds to student's 'stuid'
      'score' => '0',
    ),
    1 => 
    array (
      'assnid' => '1',
      'stuid' => '55678',
      'score' => '5',
    ),
    2 => 
    array (
      'assnid' => '1',
      'stuid' => '95956',
      'score' => '5',
    ),
    3 => 
    array (
      'assnid' => '1',
      'stuid' => '9901',
      'score' => '5',
    ),
    4 => 
    array (
      'assnid' => '1',
      'stuid' => '99010',
      'score' => '0',
    ),
    5 => 
    array (
      'assnid' => '1',
      'stuid' => '9902',
      'score' => '5',
    ),
    6 => 
    array (
      'assnid' => '1',
      'stuid' => '9903',
      'score' => '5',
    ),
    7 => 
    array (
      'assnid' => '1',
      'stuid' => '9904',
      'score' => '5',
    ),
    8 => 
    array (
      'assnid' => '1',
      'stuid' => '9905',
      'score' => '5',
    ),
    9 => 
    array (
      'assnid' => '1',
      'stuid' => '9906',
      'score' => '5',
    ),
    10 => 
    array (
      'assnid' => '1',
      'stuid' => 'ABC',
      'score' => '4',
    ),
    11 => 
    array (
      'assnid' => '4',
      'stuid' => '460798',
      'score' => '190',
    ),
    12 => 
    array (
      'assnid' => '4',
      'stuid' => '55678',
      'score' => 'E',
    ),
    13 => 
    array (
      'assnid' => '4',
      'stuid' => '95956',
      'score' => '170',
    ),
    14 => 
    array (
      'assnid' => '4',
      'stuid' => '9901',
      'score' => '175',
    ),
    15 => 
    array (
      'assnid' => '4',
      'stuid' => '99010',
      'score' => '167',
    ),
    16 => 
    array (
      'assnid' => '4',
      'stuid' => '9902',
      'score' => '150',
    ),
    17 => 
    array (
      'assnid' => '4',
      'stuid' => '9903',
      'score' => '177',
    ),
    18 => 
    array (
      'assnid' => '4',
      'stuid' => '9904',
      'score' => '175',
    ),
    19 => 
    array (
      'assnid' => '4',
      'stuid' => '9905',
      'score' => '170',
    ),
    20 => 
    array (
      'assnid' => '4',
      'stuid' => '9906',
      'score' => '180',
    ),
    21 => 
    array (
      'assnid' => '4',
      'stuid' => 'ABC',
      'score' => '190',
    ),
    22 => 
    array (
      'assnid' => '5',
      'stuid' => '460798',
      'score' => '50',
    ),
    23 => 
    array (
      'assnid' => '5',
      'stuid' => '55678',
      'score' => '45',
    ),
    24 => 
    array (
      'assnid' => '5',
      'stuid' => '95956',
      'score' => '49',
    ),
    25 => 
    array (
      'assnid' => '5',
      'stuid' => '9901',
      'score' => '40',
    ),
    26 => 
    array (
      'assnid' => '5',
      'stuid' => '99010',
      'score' => '50',
    ),
    27 => 
    array (
      'assnid' => '5',
      'stuid' => '9902',
      'score' => '49',
    ),
    28 => 
    array (
      'assnid' => '5',
      'stuid' => '9903',
      'score' => '48',
    ),
    29 => 
    array (
      'assnid' => '5',
      'stuid' => '9904',
      'score' => '48',
    ),
    30 => 
    array (
      'assnid' => '5',
      'stuid' => '9905',
      'score' => '47',
    ),
    31 => 
    array (
      'assnid' => '5',
      'stuid' => '9906',
      'score' => '50',
    ),
    32 => 
    array (
      'assnid' => '5',
      'stuid' => 'ABC',
      'score' => '49',
    ),
    33 => 
    array (
      'assnid' => '10',
      'stuid' => '460798',
      'score' => '7',
    ),
    34 => 
    array (
      'assnid' => '10',
      'stuid' => '55678',
      'score' => '5',
    ),
    35 => 
    array (
      'assnid' => '10',
      'stuid' => '95956',
      'score' => '4',
    ),
    36 => 
    array (
      'assnid' => '10',
      'stuid' => '9901',
      'score' => '6',
    ),
    37 => 
    array (
      'assnid' => '10',
      'stuid' => '99010',
      'score' => '6',
    ),
    38 => 
    array (
      'assnid' => '10',
      'stuid' => '9902',
      'score' => '7',
    ),
    39 => 
    array (
      'assnid' => '10',
      'stuid' => '9903',
      'score' => '9',
    ),
    40 => 
    array (
      'assnid' => '10',
      'stuid' => '9904',
      'score' => '8',
    ),
    41 => 
    array (
      'assnid' => '10',
      'stuid' => '9905',
      'score' => '8',
    ),
    42 => 
    array (
      'assnid' => '10',
      'stuid' => '9906',
      'score' => '10',
    ),
    43 => 
    array (
      'assnid' => '10',
      'stuid' => 'ABC',
      'score' => '9',
    ),
    44 => 
    array (
      'assnid' => '27',
      'stuid' => '460798',
      'score' => '75',
    ),
    45 => 
    array (
      'assnid' => '27',
      'stuid' => '55678',
      'score' => '75',
    ),
    46 => 
    array (
      'assnid' => '27',
      'stuid' => '95956',
      'score' => '75',
    ),
    47 => 
    array (
      'assnid' => '27',
      'stuid' => '99010',
      'score' => '75',
    ),
    48 => 
    array (
      'assnid' => '27',
      'stuid' => '9904',
      'score' => '75',
    ),
    49 => 
    array (
      'assnid' => '27',
      'stuid' => '9906',
      'score' => '75',
    ),
    50 => 
    array (
      'assnid' => '27',
      'stuid' => 'ABC',
      'score' => '78',
    ),
  ),
);

$test_array = array (
   'bla' => 'blub',
   'foo' => 'bar',
   'another_array' => array(
      'stack' => 'overflow',
   ),
);

$xml = new PhpAryToXML;
$xml->setPHPArray($class);
$obj = $xml->getXML();
var_dump($obj->asXML());
